var Ie=Object.defineProperty,Pe=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var re=(e,a,l)=>a in e?Ie(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,I=(e,a)=>{for(var l in a||(a={}))me.call(a,l)&&re(e,l,a[l]);if(se)for(var l of se(a))Ue.call(a,l)&&re(e,l,a[l]);return e},ie=(e,a)=>Pe(e,$e(a));var ue=(e,a,l)=>new Promise((k,_)=>{var C=K=>{try{p(l.next(K))}catch(v){_(v)}},s=K=>{try{p(l.throw(K))}catch(v){_(v)}},p=K=>K.done?k(K.value):Promise.resolve(K.value).then(C,s);p((l=l.apply(e,a)).next())});import{ap as je,d as be,f as Ce,af as He,c as O,w as $,Z as M,_ as U,u,N as Ve,aa as P,a7 as W,a8 as j,E as oe,a0 as de,a1 as he,l as A,F as Z,a9 as Xe,ah as Ye,ai as Re,A as qe,m as ze,r as fe,H as R,h as H,o as Je,q as ye,z as pe,ab as We,i as Ge}from"./vue-b9806415.js";import{bn as Ze,b as Qe,B as et,ak as tt,I as Q,bo as ke,at as nt,t as G,bp as at,aO as lt,bq as ct,aH as st,S as rt,ay as it,y as ge,aq as ut}from"./index.js";import{a$ as ot,b0 as dt,b1 as ht,l as ft,b2 as yt,b3 as pt,D as kt,b4 as gt,d as ee,b5 as St,o as Kt,A as xt,aj as bt,E as Se,ag as Ct}from"./antd-57936705.js";import{u as At}from"./useContextMenu-c56b6f78.js";function te(e,a){return a?typeof a=="string"?` ${e}--${a}`:Array.isArray(a)?a.reduce((l,k)=>l+te(e,k),""):Object.keys(a).reduce((l,k)=>l+(a[k]?te(e,k):""),""):""}function Lt(e){return(a,l)=>(a&&typeof a!="string"&&(l=a,a=""),a=a?`${e}__${a}`:e,`${a}${te(a,l)}`)}function Ae(e){return[Lt(`${Ze}-${e}`)]}const Ke=Symbol(),xe=Symbol();function vt(e,a){if(!dt(e)||e[xe])return e;const{values:l,required:k,default:_,type:C,validator:s}=e,p=l||s?K=>{let v=!1,L=[];if(l&&(L=[...l,_],v||(v=L.includes(K))),s&&(v||(v=s(K))),!v&&L.length>0){const h=[...new Set(L)].map(t=>JSON.stringify(t)).join(", ");je(`Invalid prop: validation failed${a?` for prop "${a}"`:""}. Expected one of [${h}], got value ${JSON.stringify(K)}.`)}return v}:void 0;return{type:typeof C=="object"&&Object.getOwnPropertySymbols(C).includes(Ke)?C[Ke]:C,required:!!k,default:_,validator:p,[xe]:!0}}const Et=e=>ot(Object.entries(e).map(([a,l])=>[a,vt(l,a)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Tt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],_t=Et({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Bt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},wt=be({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:a}){const l=e,k=Ce(""),[_]=Ae("tree-header"),C=He(),{t:s}=Qe(),p=O(()=>["mr-1","w-full",{"ml-5":C.headerTitle||l.title}]),K=O(()=>{const{checkable:t}=l,c=[{label:s("component.tree.expandAll"),value:T.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:t}];return t?[{label:s("component.tree.selectAll"),value:T.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:t},...c,{label:s("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:c});function v(t){var i,d,o,r;const{key:c}=t;switch(c){case T.SELECT_ALL:(i=l.checkAll)==null||i.call(l,!0);break;case T.UN_SELECT_ALL:(d=l.checkAll)==null||d.call(l,!1);break;case T.EXPAND_ALL:(o=l.expandAll)==null||o.call(l,!0);break;case T.UN_EXPAND_ALL:(r=l.expandAll)==null||r.call(l,!1);break;case T.CHECK_STRICTLY:a("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:a("strictly-change",!0);break}}function L(t){a("search",t)}const h=et(L,200);return $(()=>k.value,t=>{h(t)}),$(()=>l.searchText,t=>{t!==k.value&&(k.value=t)}),(t,c)=>(M(),U("div",{class:he([u(_)(),"flex px-2 py-1.5 items-center"])},[u(C).headerTitle?Ve(t.$slots,"headerTitle",{key:0}):P("",!0),!u(C).headerTitle&&t.title?(M(),W(u(tt),{key:1,helpMessage:t.helpMessage},{default:j(()=>[oe(de(t.title),1)]),_:1},8,["helpMessage"])):P("",!0),t.search||t.toolbar?(M(),U("div",Bt,[t.search?(M(),U("div",{key:0,class:he(p.value)},[A(u(ht),{placeholder:u(s)("common.searchText"),size:"small",allowClear:"",value:k.value,"onUpdate:value":c[0]||(c[0]=i=>k.value=i)},null,8,["placeholder","value"])],2)):P("",!0),t.toolbar?(M(),W(u(kt),{key:1,onClick:c[1]||(c[1]=qe(()=>{},["prevent"]))},{overlay:j(()=>[A(u(ft),{onClick:v},{default:j(()=>[(M(!0),U(Z,null,Xe(K.value,i=>(M(),U(Z,{key:i.value},[A(u(yt),Ye(Re({key:i.value})),{default:j(()=>[oe(de(i.label),1)]),_:2},1040),i.divider?(M(),W(u(pt),{key:0})):P("",!0)],64))),128))]),_:1})]),default:j(()=>[A(Q,{icon:"ion:ellipsis-vertical"})]),_:1})):P("",!0)])):P("",!0)],2))}}),Ft=({icon:e})=>e?gt(e)?ze(Q,{icon:e,class:"mr-1"}):Q:null;function Dt(e,a){function l(h){const t=[],c=h||u(e),{key:i,children:d}=u(a);if(!d||!i)return t;for(let o=0;o<c.length;o++){const r=c[o];t.push(r[i]);const y=r[d];y&&y.length&&t.push(...l(y))}return t}function k(h){const t=[],c=h||u(e),{key:i,children:d}=u(a);if(!d||!i)return t;for(let o=0;o<c.length;o++){const r=c[o];r.disabled!==!0&&r.selectable!==!1&&t.push(r[i]);const y=r[d];y&&y.length&&t.push(...k(y))}return t}function _(h,t){const c=[],i=t||u(e),{key:d,children:o}=u(a);if(!o||!d)return c;for(let r=0;r<i.length;r++){const y=i[r],E=y[o];h===y[d]?(c.push(y[d]),E&&E.length&&c.push(...l(E))):E&&E.length&&c.push(..._(h,E))}return c}function C(h,t,c){if(!h)return;const i=c||u(e),{key:d,children:o}=u(a);if(!(!o||!d))for(let r=0;r<i.length;r++){const y=i[r],E=y[o];if(y[d]===h){i[r]=I(I({},i[r]),t);break}else E&&E.length&&C(h,t,y[o])}}function s(h=1,t,c=1){if(!h)return[];const i=[],d=t||u(e)||[];for(let o=0;o<d.length;o++){const r=d[o],{key:y,children:E}=u(a),q=y?r[y]:"",m=E?r[E]:[];i.push(q),m&&m.length&&c<h&&(c+=1,i.push(...s(h,m,c)))}return i}function p({parentKey:h=null,node:t,push:c="push"}){const i=ee(u(e));if(!h){i[c](t),e.value=i;return}const{key:d,children:o}=u(a);!o||!d||(ke(i,r=>{if(r[d]===h)return r[o]=r[o]||[],r[o][c](t),!0}),e.value=i)}function K({parentKey:h=null,list:t,push:c="push"}){const i=ee(u(e));if(!(!t||t.length<1))if(h){const{key:d,children:o}=u(a);if(!o||!d)return;ke(i,r=>{if(r[d]===h){r[o]=r[o]||[];for(let y=0;y<t.length;y++)r[o][c](t[y]);return e.value=i,!0}})}else{for(let d=0;d<t.length;d++)i[c](t[d]);e.value=i;return}}function v(h,t){if(!h)return;const c=t||u(e),{key:i,children:d}=u(a);if(!(!d||!i))for(let o=0;o<c.length;o++){const r=c[o],y=r[d];if(r[i]===h){c.splice(o,1);break}else y&&y.length&&v(h,r[d])}}function L(h,t,c){if(!h&&h!==0)return null;const i=t||u(e),{key:d,children:o}=u(a);if(d)return i.forEach(r=>{if(c!=null&&c.key||(c==null?void 0:c.key)===0)return c;if(r[d]===h){c=r;return}r[o]&&r[o].length&&(c=L(h,r[o],c))}),c||null}return{deleteNodeByKey:v,insertNodeByKey:p,insertNodesByKey:K,filterByLevel:s,updateNodeByKey:C,getAllKeys:l,getChildrenKeys:_,getEnabledKeys:k,getSelectedNode:L}}function Nt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ge(e)}const mt=be({name:"BasicTree",inheritAttrs:!1,props:_t,emits:Tt,setup(e,{attrs:a,slots:l,emit:k,expose:_}){const[C]=Ae("tree"),s=fe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=fe({startSearch:!1,searchText:"",searchData:[]}),K=Ce([]),[v]=At(),L=O(()=>{const{fieldNames:n}=e;return I({children:"children",title:"title",key:"key"},n)}),h=O(()=>{let n=ie(I(I({blockNode:!0},a),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,fieldNames:u(L),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,k("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,k("update:selectedKeys",f)},onCheck:(f,x)=>{let g=R(s.checkedKeys);if(nt(g)&&p.startSearch){const b=x.node.eventKey;g=St(g,q(b)),x.checked&&g.push(b),s.checkedKeys=g}else s.checkedKeys=f;const S=R(s.checkedKeys);k("update:value",S),k("check",S,x)},onRightClick:Ee});return Kt(n,"treeData","class")}),t=O(()=>p.startSearch?p.searchData:u(K)),c=O(()=>!t.value||t.value.length===0),{deleteNodeByKey:i,insertNodeByKey:d,insertNodesByKey:o,filterByLevel:r,updateNodeByKey:y,getAllKeys:E,getChildrenKeys:q,getEnabledKeys:m,getSelectedNode:Le}=Dt(K,L);function ve(n,f){return!f&&e.renderIcon&&G(e.renderIcon)?e.renderIcon(n):f}function Ee(x){return ue(this,arguments,function*({event:n,node:f}){var F;const{rightMenuList:g=[],beforeRightClick:S}=e;let b={event:n,items:[]};if(S&&G(S)){let B=yield S(f,n);Array.isArray(B)?b.items=B:Object.assign(b,B)}else b.items=g;(F=b.items)!=null&&F.length&&(b.items=b.items.filter(B=>!B.hidden),v(b))})}function V(n){s.expandedKeys=n}function Te(){return s.expandedKeys}function ne(n){s.selectedKeys=n}function _e(){return s.selectedKeys}function ae(n){s.checkedKeys=n}function Be(){return s.checkedKeys}function le(n){s.checkedKeys=n?m():[]}function z(n){s.expandedKeys=n?E():[]}function we(n){s.checkStrictly=n}$(()=>e.searchValue,n=>{n!==p.searchText&&(p.searchText=n)},{immediate:!0}),$(()=>e.treeData,n=>{n&&J(p.searchText)});function J(n){if(n!==p.searchText&&(p.searchText=n),k("update:searchValue",n),!n){p.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:g,checkOnSearch:S,selectedOnSearch:b}=u(e);p.startSearch=!0;const{title:F,key:B}=u(L),D=[];if(p.searchData=at(u(K),w=>{var X,Y;const N=f?f(n,w,u(L)):(Y=(X=w[F])==null?void 0:X.includes(n))!=null?Y:!1;return N&&D.push(w[B]),N},u(L)),g){const w=lt(p.searchData).map(N=>N[B]);w&&w.length&&V(w)}S&&x&&D.length&&ae(D),b&&D.length&&ne(D)}function Fe(n,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(n))V([...s.expandedKeys,n]);else{const x=[...s.expandedKeys],g=x.findIndex(S=>S===n);g!==-1&&x.splice(g,1),V(x)}}H(()=>{K.value=e.treeData}),Je(()=>{const n=parseInt(e.defaultExpandLevel);n>0?s.expandedKeys=r(n):e.defaultExpandAll&&z(!0)}),H(()=>{s.expandedKeys=e.expandedKeys}),H(()=>{s.selectedKeys=e.selectedKeys}),H(()=>{s.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{s.checkedKeys=R(e.value||[])},{immediate:!0}),$(()=>s.checkedKeys,()=>{const n=R(s.checkedKeys);k("update:value",n),k("change",n)}),H(()=>{s.checkStrictly=e.checkStrictly});const De={setExpandedKeys:V,getExpandedKeys:Te,setSelectedKeys:ne,getSelectedKeys:_e,setCheckedKeys:ae,getCheckedKeys:Be,insertNodeByKey:d,insertNodesByKey:o,deleteNodeByKey:i,updateNodeByKey:y,getSelectedNode:Le,checkAll:le,expandAll:z,filterByLevel:n=>{s.expandedKeys=r(n)},setSearchValue:n=>{J(n)},getSearchValue:()=>p.searchText};function Ne(n){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,g)=>{var b;let S=!0;return G(x.show)?S=(b=x.show)==null?void 0:b.call(x,n):ge(x.show)&&(S=x.show),S?A("span",{key:g,class:C("action")},[x.render(n)]):null})}const Me=O(()=>{const n=ee(t.value);return ct(n,(f,x)=>{var ce;const g=p.searchText,{highlight:S}=u(e),{title:b,key:F,children:B}=u(L),D=ve(f,f.icon),w=Ct(f,b),N=g?w.indexOf(g):-1,X=p.startSearch&&!it(g)&&S&&N!==-1,Y=`color: ${ge(S)?"#f50":S}`,Oe=X?A("span",{class:(ce=u(h))!=null&&ce.blockNode?`${C("content")}`:""},[A("span",null,[w.substr(0,N)]),A("span",{style:Y},[g]),A("span",null,[w.substr(N+g.length)])]):w;return f[b]=A("span",{class:`${C("title")} pl-2`,onClick:Fe.bind(null,f[F],f[B])},[l!=null&&l.title?ut(l,"title",f):A(Z,null,[D&&A(Ft,{icon:D},null),Oe,A("span",{class:C("actions")},[Ne(f)])])]),f}),n});return _(De),()=>{let n;const{title:f,helpMessage:x,toolbar:g,search:S,checkable:b}=e,F=f||g||S||l.headerTitle,B={height:"calc(100% - 38px)"};return A("div",{class:[C(),"h-full",a.class]},[F&&A(wt,{checkable:b,checkAll:le,expandAll:z,title:f,search:S,toolbar:g,helpMessage:x,onStrictlyChange:we,onSearch:J,searchText:p.searchText},Nt(n=st(l))?n:{default:()=>[n]}),A(xt,{wrapperClassName:u(e.treeWrapperClassName),spinning:u(e.loading),tip:"加载中..."},{default:()=>[ye(A(rt,{style:B},{default:()=>[A(bt,We(u(h),{showIcon:!1,treeData:Me.value}),null)]}),[[pe,!u(c)]]),ye(A(Se,{image:Se.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[pe,u(c)]])]})])}}});export{mt as _};
