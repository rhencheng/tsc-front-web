var Rt=Object.defineProperty,$t=Object.defineProperties;var _t=Object.getOwnPropertyDescriptors;var Ue=Object.getOwnPropertySymbols;var kt=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable;var Ge=(e,o,t)=>o in e?Rt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,H=(e,o)=>{for(var t in o||(o={}))kt.call(o,t)&&Ge(e,t,o[t]);if(Ue)for(var t of Ue(o))Ft.call(o,t)&&Ge(e,t,o[t]);return e},fe=(e,o)=>$t(e,_t(o));var oe=(e,o,t)=>new Promise((s,l)=>{var u=i=>{try{c(t.next(i))}catch(a){l(a)}},d=i=>{try{c(t.throw(i))}catch(a){l(a)}},c=i=>i.done?s(i.value):Promise.resolve(i.value).then(u,d);c((t=t.apply(e,o)).next())});import{B as It}from"./BasicForm-152e2559.js";import{P as Oe,g as Ht,D as Pt,I as Ae,A as Be,R as ee,F as Dt,u as ze,i as Ot}from"./BasicForm.vue_vue_type_style_index_0_lang-8c66020c.js";import{u as At}from"./useForm-4dc53c5d.js";import{_ as ne,aK as Xe,h as Ke,b as Te,y as X,at as Pe,aB as Bt,t as j,ag as Le,aL as Kt,aM as Lt,o as Et,z as Nt,aN as Mt,B as zt,ah as Vt,U as Wt,ak as qt,aq as Ne,aJ as jt,aj as Ut,aC as Gt}from"./index.js";import{aC as Xt,aD as Zt,aE as Yt,d as De,a as Jt,aF as Qt,ag as Ze,o as nt,a0 as xt,T as ot,Y as en,Z as tn,a6 as nn,aG as on}from"./antd-57936705.js";import{d as me,a6 as R,Z as A,_ as ge,N as de,E as ae,a0 as M,l as k,c as F,f as W,w as Ce,u as n,H as he,m as Ve,r as at,h as We,o as an,n as ye,a7 as z,a8 as v,$ as te,a1 as pe,F as Ye,a9 as Me,aa as G,e as ln,ac as Je,ah as Ie,ai as He,ab as Qe,q as sn,z as rn}from"./vue-b9806415.js";import{_ as cn,a as un,b as fn,c as dn,d as gn}from"./TableImg.vue_vue_type_style_index_0_lang-0c7200ee.js";import{b as xe}from"./uuid-31b8b5a4.js";import{a as hn}from"./index-7caba1aa.js";import{u as mn}from"./useWindowSizeFn-da6b5cad.js";import{o as pn}from"./onMountedOrActivated-b65981ee.js";const Cn=me({name:"EditTableHeaderIcon",components:{FormOutlined:Xt},props:{title:{type:String,default:""}}}),bn={class:"edit-header-cell"};function Sn(e,o,t,s,l,u){const d=R("FormOutlined");return A(),ge("span",bn,[de(e.$slots,"default"),ae(" "+M(e.title)+" ",1),k(d)])}const et=ne(Cn,[["render",Sn]]),yn=me({name:"TableHeaderCell",components:{EditTableHeaderCell:et,BasicHelp:Xe},props:{column:{type:Object,default:()=>({})}},setup(e){const{prefixCls:o}=Ke("basic-table-header-cell"),t=F(()=>{var u;return!!((u=e.column)!=null&&u.edit)}),s=F(()=>{var d,c;const u=e.column;return typeof u.customHeaderRender=="function"?u.customHeaderRender(e.column):((d=e.column)==null?void 0:d.customTitle)||((c=e.column)==null?void 0:c.title)}),l=F(()=>{var u;return(u=e.column)==null?void 0:u.helpMessage});return()=>k("div",null,[t.value?k(et,null,{default:()=>[s.value]}):k("span",{class:"default-header-cell"},[s.value]),l.value&&k(Xe,{text:l.value,class:`${o}__help`},null)])}});function wn({page:e,type:o,originalElement:t}){return o==="prev"?e===0?null:k(Zt,null,null):o==="next"?e===1?null:k(Yt,null,null):t}function Tn(e){const{t:o}=Te(),t=W({}),s=W(!0);Ce(()=>n(e).pagination,a=>{!X(a)&&a&&(t.value=H(H({},n(t)),a!=null?a:{}))});const l=F(()=>{const{pagination:a}=n(e);return!n(s)||X(a)&&!a?!1:H(H({current:1,pageSize:Oe,size:"small",defaultPageSize:Oe,showTotal:C=>o("component.table.total",{total:C}),showSizeChanger:!0,pageSizeOptions:Ht,itemRender:wn,showQuickJumper:!0},X(a)?{}:a),n(t))});function u(a){const C=n(l);t.value=H(H({},X(C)?{}:C),a)}function d(){return n(l)}function c(){return n(s)}function i(a){return oe(this,null,function*(){s.value=a})}return{getPagination:d,getPaginationInfo:l,setShowPagination:i,getShowPagination:c,setPagination:u}}function vn(e){return({text:o,record:t,index:s})=>(he(t).onValid=()=>oe(this,null,function*(){if(Pe(t==null?void 0:t.validCbs)){const l=((t==null?void 0:t.validCbs)||[]).map(d=>d());return(yield Promise.all(l)).every(d=>!!d)}else return!1}),he(t).onEdit=(l,u=!1)=>oe(this,null,function*(){var d,c;return u||(t.editable=l),!l&&u?(yield t.onValid())&&(yield(d=t.onSubmitEdit)==null?void 0:d.call(t))?(t.editable=!1,!0):!1:(!l&&!u&&((c=t.onCancelEdit)==null||c.call(t)),!0)}),Ve(cn,{value:o,record:t,column:e,index:s}))}function lt(e,o){const{key:t,dataIndex:s,children:l}=e;e.align=e.align||Pt,o&&(t||(e.key=s),X(e.ellipsis)||Object.assign(e,{ellipsis:o})),l&&l.length&&st(l,!!o)}function st(e,o){e&&e.forEach(t=>{const{children:s}=t;lt(t,o),st(s,o)})}function Rn(e,o,t){const{t:s}=Te(),{showIndexColumn:l,indexColumnProps:u,isTreeTable:d}=n(e);let c=!1;if(n(d)||(t.forEach(()=>{const a=t.findIndex(C=>C.flag===Ae);l?c=a===-1:!l&&a!==-1&&t.splice(a,1)}),!c))return;const i=t.some(a=>a.fixed==="left");t.unshift(H(H({flag:Ae,width:50,title:s("component.table.index"),align:"center",customRender:({index:a})=>{const C=n(o);if(X(C))return`${a+1}`;const{current:_=1,pageSize:P=Oe}=C;return((_<1?1:_)-1)*P+a+1}},i?{fixed:"left"}:{}),u))}function $n(e,o){const{actionColumn:t}=n(e);if(!t)return;const s=o.findIndex(l=>l.flag===Be);s===-1&&o.push(fe(H(fe(H({},o[s]),{fixed:"right"}),t),{flag:Be}))}function _n(e,o){const t=W(n(e).columns);let s=n(e).columns;const l=F(()=>{const g=De(n(t));if(Rn(e,o,g),$n(e,g),!g)return[];const{ellipsis:p}=n(e);return g.forEach(f=>{const{customRender:h,slots:b}=f;lt(f,Reflect.has(f,"ellipsis")?!!f.ellipsis:!!p&&!h&&!b)}),g});function u(g){const p=g.ifShow;let f=!0;return X(p)&&(f=p),j(p)&&(f=p(g)),f}const{hasPermission:d}=Bt(),c=F(()=>{const g=tt(n(l)),p=h=>{const{slots:b,customRender:B,format:D,edit:L,editRow:E,flag:q}=h;(!b||!(b!=null&&b.title))&&(h.customTitle=h.title,Reflect.deleteProperty(h,"title"));const le=[Ae,Be].includes(q);return!B&&D&&!L&&!le&&(h.customRender=({text:y,record:w,index:r})=>kn(y,D,w,r)),(L||E)&&!le&&(h.customRender=vn(h)),at(h)};return De(g).filter(h=>d(h.auth)&&u(h)).map(h=>{var b;return(b=h.children)!=null&&b.length&&(h.children=h.children.map(p)),p(h)})});Ce(()=>n(e).columns,g=>{var p;t.value=g,s=(p=g==null?void 0:g.filter(f=>!f.flag))!=null?p:[]});function i(g,p){!g||!p||s.forEach(f=>{if(f.dataIndex===g){Object.assign(f,p);return}})}function a(g){const p=De(g);if(!Pe(p))return;if(p.length<=0){t.value=[];return}const f=p[0],h=s.map(b=>b.dataIndex);if(!Le(f)&&!Pe(f))t.value=p;else{const b=p.map(D=>D.toString()),B=[];s.forEach(D=>{var L;B.push(fe(H({},D),{defaultHidden:!b.includes(((L=D.dataIndex)==null?void 0:L.toString())||D.key)}))}),Jt(h,p)||B.sort((D,L)=>{var E,q;return b.indexOf((E=D.dataIndex)==null?void 0:E.toString())-b.indexOf((q=L.dataIndex)==null?void 0:q.toString())}),t.value=B}}function C(g){const{ignoreIndex:p,ignoreAction:f,sort:h}=g||{};let b=he(n(l));return p&&(b=b.filter(B=>B.flag!==Ae)),f&&(b=b.filter(B=>B.flag!==Be)),h&&(b=tt(b)),b}function _(){return s}function P(g){Pe(g)&&(s=g.filter(p=>!p.flag))}return{getColumnsRef:l,getCacheColumns:_,getColumns:C,setColumns:a,getViewColumns:c,setCacheColumnsByField:i,setCacheColumns:P}}function tt(e){const o=[],t=[],s=[];for(const l of e){if(l.fixed==="left"){o.push(l);continue}if(l.fixed==="right"){t.push(l);continue}s.push(l)}return[...o,...s,...t].filter(l=>!l.defaultHidden)}function kn(e,o,t,s){if(!o)return e;if(j(o))return o(e,t,s);try{const l="date|";if(Le(o)&&o.startsWith(l)&&e){const u=o.replace(l,"");return u?Kt(e,u):e}if(Lt(o))return o.get(e)}catch(l){return e}}function Fn(e,{getPaginationInfo:o,setPagination:t,setLoading:s,getFieldsValue:l,clearSelectedRowKeys:u,tableData:d},c){const i=at({sortInfo:{},filterInfo:{}}),a=W([]),C=W({});We(()=>{d.value=n(a)}),Ce(()=>n(e).dataSource,()=>{const{dataSource:r,api:m}=n(e);!m&&r&&(a.value=r)},{immediate:!0});function _(r,m,S){const{clearSelectOnPageChange:$,sortFn:O,filterFn:I}=n(e);$&&u(),t(r);const K={};if(S&&j(O)){const T=O(S);i.sortInfo=T,K.sortInfo=T}if(m&&j(I)){const T=I(m);i.filterInfo=T,K.filterInfo=T}E(K)}function P(r){!r||!Array.isArray(r)||r.forEach(m=>{m[ee]||(m[ee]=xe()),m.children&&m.children.length&&P(m.children)})}const g=F(()=>n(e).autoCreateKey&&!n(e).rowKey),p=F(()=>{const{rowKey:r}=n(e);return n(g)?ee:r}),f=F(()=>{const r=n(a);if(!r||r.length===0)return n(a);if(n(g)){const m=r[0],S=r[r.length-1];if(m&&S&&(!m[ee]||!S[ee])){const $=De(n(a));$.forEach(O=>{O[ee]||(O[ee]=xe()),O.children&&O.children.length&&P(O.children)}),a.value=$}}return n(a)});function h(r,m,S){return oe(this,null,function*(){return a.value[r]&&(a.value[r][m]=S),a.value[r]})}function b(r,m){const S=L(r);if(S){for(const $ in S)Reflect.has(m,$)&&(S[$]=m[$]);return S}}function B(r){var O;if(!a.value||a.value.length==0)return;const m=n(p);if(!m)return;const S=Array.isArray(r)?r:[r];function $(I,K){const T=Z(I,K);if(T===null||T.index===-1)return;T.data.splice(T.index,1);function Z(N,U){var se;if(N==null)return null;for(let J=0;J<N.length;J++){const Q=N[J];let ie=m;if(j(m)&&(ie=m(Q)),Q[ie]===U)return{index:J,data:N};if(((se=Q.children)==null?void 0:se.length)>0){const x=Z(Q.children,U);if(x!=null)return x}}return null}}for(const I of S)$(a.value,I),$(n(e).dataSource,I);t({total:(O=n(e).dataSource)==null?void 0:O.length})}function D(r,m){var $;m=m!=null?m:($=a.value)==null?void 0:$.length;const S=Nt(r)?[r]:r;return n(a).splice(m,0,...S),n(a)}function L(r){if(!a.value||a.value.length==0)return;const m=n(p);if(!m)return;const{childrenColumnName:S="children"}=n(e);return(O=>{let I;return O.some(function K(T){if(typeof m=="function"){if(m(T)===r)return I=T,!0}else if(Reflect.has(T,m)&&T[m]===r)return I=T,!0;return T[S]&&T[S].some(K)}),I})(a.value)}function E(r){return oe(this,null,function*(){var N,U,se;const{api:m,searchInfo:S,defSort:$,fetchSetting:O,beforeFetch:I,afterFetch:K,useSearchForm:T,pagination:Z}=n(e);if(!(!m||!j(m)))try{s(!0);const{pageField:J,sizeField:Q,listField:ie,totalField:x}=Object.assign({},Dt,O);let re={};const{current:ve=1,pageSize:Re=Oe}=n(o);X(Z)&&!Z||X(o)?re={}:(re[J]=r&&r.page||ve,re[Q]=Re);const{sortInfo:$e={},filterInfo:Ee}=i;let be=Qt(re,T?l():{},S,(N=r==null?void 0:r.searchInfo)!=null?N:{},$,$e,Ee,(U=r==null?void 0:r.sortInfo)!=null?U:{},(se=r==null?void 0:r.filterInfo)!=null?se:{});I&&j(I)&&(be=(yield I(be))||be);const ce=yield m(be);C.value=ce;const _e=Array.isArray(ce);let ue=_e?ce:Ze(ce,ie);const Se=_e?ce.length:Ze(ce,x);if(Number(Se)){const we=Math.ceil(Se/Re);if(ve>we)return t({current:we}),yield E(r)}return K&&j(K)&&(ue=(yield K(ue))||ue),a.value=ue,t({total:Se||0}),r&&r.page&&t({current:r.page||1}),c("fetch-success",{items:n(ue),total:Se}),ue}catch(J){c("fetch-error",J),a.value=[],t({total:0})}finally{s(!1)}})}function q(r){a.value=r}function le(){return f.value}function y(){return C.value}function w(r){return oe(this,null,function*(){return yield E(r)})}return an(()=>{Et(()=>{n(e).immediate&&E()},16)}),{getDataSourceRef:f,getDataSource:le,getRawDataSource:y,getRowKey:p,setTableData:q,getAutoCreateKey:g,fetch:E,reload:w,updateTableData:h,updateTableDataRecord:b,deleteTableDataRecord:B,insertTableDataRecord:D,findTableDataRecord:L,handleTableChange:_}}function In(e){const o=W(n(e).loading);Ce(()=>n(e).loading,l=>{o.value=l});const t=F(()=>n(o));function s(l){o.value=l}return{getLoading:t,setLoading:s}}function Hn(e,o,t){const s=W([]),l=W([]),u=F(()=>{const{rowSelection:f}=n(e);return f?H({selectedRowKeys:n(s),onChange:h=>{i(h)}},nt(f,["onChange"])):null});Ce(()=>{var f;return(f=n(e).rowSelection)==null?void 0:f.selectedRowKeys},f=>{i(f)}),Ce(()=>n(s),()=>{ye(()=>{const{rowSelection:f}=n(e);if(f){const{onChange:h}=f;h&&j(h)&&h(P(),g())}t("selection-change",{keys:P(),rows:g()})})},{deep:!0});const d=F(()=>n(e).autoCreateKey&&!n(e).rowKey),c=F(()=>{const{rowKey:f}=n(e);return n(d)?ee:f});function i(f){var B;s.value=f;const h=Mt(he(n(o)).concat(he(n(l))),D=>f==null?void 0:f.includes(D[n(c)]),{children:(B=e.value.childrenColumnName)!=null?B:"children"}),b=[];f==null||f.forEach(D=>{const L=h.find(E=>E[n(c)]===D);L&&b.push(L)}),l.value=b}function a(f){l.value=f}function C(){l.value=[],s.value=[]}function _(f){const b=n(s).findIndex(B=>B===f);b!==-1&&n(s).splice(b,1)}function P(){return n(s)}function g(){return n(l)}function p(){return n(u)}return{getRowSelection:p,getRowSelectionRef:u,getSelectRows:g,getSelectRowKeys:P,setSelectedRowKeys:i,clearSelectedRowKeys:C,deleteSelectRowByKey:_,setSelectedRows:a}}function Pn(e,o,t,s,l,u,d){const c=W(167),i=hn(),a=zt(_,100),C=F(()=>{const{canResize:y,scroll:w}=n(e);return y&&!(w||{}).y});Ce(()=>{var y;return[n(C),(y=n(l))==null?void 0:y.length]},()=>{a()},{flush:"post"});function _(){ye(()=>{E()})}function P(y){var w;c.value=y,(w=i==null?void 0:i.redoModalHeight)==null||w.call(i)}let g,p,f;function h(y,w){const r=y.scrollHeight>y.clientHeight,m=y.scrollWidth>y.clientWidth;r?w.classList.contains("hide-scrollbar-y")&&w.classList.remove("hide-scrollbar-y"):!w.classList.contains("hide-scrollbar-y")&&w.classList.add("hide-scrollbar-y"),m?w.classList.contains("hide-scrollbar-x")&&w.classList.remove("hide-scrollbar-x"):!w.classList.contains("hide-scrollbar-x")&&w.classList.add("hide-scrollbar-x")}function b(y){const{pagination:w}=n(e);let r=2;if(X(w))r=-8;else if(g=y.querySelector(".ant-pagination"),g){const m=g.offsetHeight;r+=m||0}else r+=24;return r}function B(y){const{pagination:w}=n(e);let r=0;if(!X(w))if(!p)p=y.querySelector(".ant-table-footer");else{const m=p.offsetHeight;r+=m||0}return r}function D(y){let w=0;return y&&(w=y.offsetHeight),w}function L(y,w){var I,K,T,Z,N,U;const{pagination:r,isCanResizeParent:m,useSearchForm:S}=n(e);let $=30,O=0;if(n(u)&&m){let Q=10;const ie=(K=(I=n(u))==null?void 0:I.offsetHeight)!=null?K:0;let x=(Z=(T=n(d))==null?void 0:T.$el.offsetHeight)!=null?Z:0;x&&(x+=16),X(r)&&!r&&(Q=0),X(S)&&!S&&($=0);const re=(U=(N=y.querySelector(".ant-table-title"))==null?void 0:N.offsetHeight)!=null?U:0;O=ie-x-re-12-Q}else O=Vt(w).bottomIncludeBody;return{paddingHeight:$,bottomIncludeBody:O}}function E(){return oe(this,null,function*(){var U;const{resizeHeightOffset:y,maxHeight:w}=n(e),r=n(l),m=n(o);if(!m)return;const S=m.$el;if(!S||!f&&(f=S.querySelector(".ant-table-body"),!f)||(h(f,S),f.style.height="unset",!n(C)||!n(r)||r.length===0))return;yield ye();const $=S.querySelector(".ant-table-thead ");if(!$)return;const O=b(S),I=B(S),K=D($),{paddingHeight:T,bottomIncludeBody:Z}=L(S,$);let N=Z-(y||0)-T-O-I-K;N=(U=N>w?w:N)!=null?U:N,P(N),f.style.height=`${N}px`})}mn(E,{wait:280}),pn(()=>{E(),ye(()=>{a()})});const q=F(()=>{var I,K;let y=0;n(s)&&(y+=60);const w=150,r=n(t).filter(T=>!T.defaultHidden);r.forEach(T=>{y+=Number.parseFloat(T.width)||0});const S=r.filter(T=>!Reflect.has(T,"width")).length;S!==0&&(y+=S*w);const $=n(o);return((K=(I=$==null?void 0:$.$el)==null?void 0:I.offsetWidth)!=null?K:0)>y?"100%":y});return{getScrollRef:F(()=>{const y=n(c),{canResize:w,scroll:r}=n(e);return H({x:n(q),y:w?y:null,scrollToFirstRowOnChange:!1},r)}),redoHeight:_}}function Dn(e,o){let t;function s(u){return oe(this,null,function*(){var i;const{id:d}=u,c=t==null?void 0:t.querySelector(`[data-row-key="${d}"]`);yield ye(),t==null||t.scrollTo({top:(i=c==null?void 0:c.offsetTop)!=null?i:0,behavior:"smooth"})})}function l(u){const d=n(e);if(!d)return;const c=d.$el;if(!c||!t&&(t=c.querySelector(".ant-table-body"),!t))return;const i=n(o);if(i)if(u==="top")s(i[0]);else if(u==="bottom")s(i[i.length-1]);else{const a=i.find(C=>C.id===u);a&&s(a)}}return{scrollTo:l}}function On(e,o,t){return!o||t?e[ee]:Le(o)?e[o]:j(o)?e[o(e)]:null}function An(e,{setSelectedRowKeys:o,getSelectRowKeys:t,getAutoCreateKey:s,clearSelectedRowKeys:l,emit:u}){return{customRow:(c,i)=>({onClick:a=>{a==null||a.stopPropagation();function C(){var B;const{rowSelection:_,rowKey:P,clickToRowSelect:g}=n(e);if(!_||!g)return;const p=t()||[],f=On(c,P,n(s));if(f===null)return;if(_.type==="checkbox"){const D=(B=a.composedPath)==null?void 0:B.call(a).find(q=>q.tagName==="TR");if(!D)return;const L=D.querySelector("input[type=checkbox]");if(!L||L.hasAttribute("disabled"))return;if(!p.includes(f)){p.push(f),o(p);return}const E=p.findIndex(q=>q===f);p.splice(E,1),o(p);return}if(_.type==="radio"){if(!p.includes(f)){p.length&&l(),o([f]);return}l()}}C(),u("row-click",c,i,a)},onDblclick:a=>{u("row-dbClick",c,i,a)},onContextmenu:a=>{u("row-contextmenu",c,i,a)},onMouseenter:a=>{u("row-mouseenter",c,i,a)},onMouseleave:a=>{u("row-mouseleave",c,i,a)}})}}function Bn(e,o){function t(s,l){const{striped:u,rowClassName:d}=n(e),c=[];return u&&c.push((l||0)%2===1?`${o}-row__striped`:""),d&&j(d)&&c.push(d(s,l)),c.filter(i=>!!i).join(" ")}return{getRowClassName:t}}function Kn(e,o,t,s,l,u){const d=R("Checkbox"),c=R("a-button"),i=R("DragOutlined"),a=R("Icon"),C=R("Tooltip"),_=R("Divider"),P=R("CheckboxGroup"),g=R("ScrollContainer"),p=R("SettingOutlined"),f=R("Popover");return A(),z(C,{placement:"top"},{title:v(()=>[te("span",null,M(e.t("component.table.settingColumn")),1)]),default:v(()=>[k(f,{placement:"bottomLeft",trigger:"click",onOpenChange:e.handleVisibleChange,overlayClassName:`${e.prefixCls}__cloumn-list`,getPopupContainer:e.getPopupContainer},{title:v(()=>[te("div",{class:pe(`${e.prefixCls}__popover-title`)},[k(d,{indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":o[0]||(o[0]=h=>e.checkAll=h),onChange:e.onCheckAllChange},{default:v(()=>[ae(M(e.t("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked","onChange"]),k(d,{checked:e.checkIndex,"onUpdate:checked":o[1]||(o[1]=h=>e.checkIndex=h),onChange:e.handleIndexCheckChange},{default:v(()=>[ae(M(e.t("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked","onChange"]),k(d,{checked:e.checkSelect,"onUpdate:checked":o[2]||(o[2]=h=>e.checkSelect=h),onChange:e.handleSelectCheckChange,disabled:!e.defaultRowSelection},{default:v(()=>[ae(M(e.t("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked","onChange","disabled"]),k(c,{size:"small",type:"link",onClick:e.reset},{default:v(()=>[ae(M(e.t("common.resetText")),1)]),_:1},8,["onClick"])],2)]),content:v(()=>[k(g,null,{default:v(()=>[k(P,{value:e.checkedList,"onUpdate:value":o[3]||(o[3]=h=>e.checkedList=h),onChange:e.onChange,ref:"columnListRef"},{default:v(()=>[(A(!0),ge(Ye,null,Me(e.plainOptions,h=>(A(),ge(Ye,{key:h.value},["ifShow"in h&&!h.ifShow?G("",!0):(A(),ge("div",{key:0,class:pe(`${e.prefixCls}__check-item`)},[k(i,{class:"table-column-drag-icon"}),k(d,{value:h.value},{default:v(()=>[ae(M(h.label),1)]),_:2},1032,["value"]),k(C,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:v(()=>[ae(M(e.t("component.table.settingFixedLeft")),1)]),default:v(()=>[k(a,{icon:"line-md:arrow-align-left",class:pe([`${e.prefixCls}__fixed-left`,{active:h.fixed==="left",disabled:!e.checkedList.includes(h.value)}]),onClick:b=>e.handleColumnFixed(h,"left")},null,8,["class","onClick"])]),_:2},1032,["getPopupContainer"]),k(_,{type:"vertical"}),k(C,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:v(()=>[ae(M(e.t("component.table.settingFixedRight")),1)]),default:v(()=>[k(a,{icon:"line-md:arrow-align-left",class:pe([`${e.prefixCls}__fixed-right`,{active:h.fixed==="right",disabled:!e.checkedList.includes(h.value)}]),onClick:b=>e.handleColumnFixed(h,"right")},null,8,["class","onClick"])]),_:2},1032,["getPopupContainer"])],2))],64))),128))]),_:1},8,["value","onChange"])]),_:1})]),default:v(()=>[k(p)]),_:1},8,["onOpenChange","overlayClassName","getPopupContainer"])]),_:1})}const Ln=ne(un,[["render",Kn]]);function En(e,o,t,s,l,u){const d=R("ColumnHeightOutlined"),c=R("MenuItem"),i=R("Menu"),a=R("Dropdown"),C=R("Tooltip");return A(),z(C,{placement:"top"},{title:v(()=>[te("span",null,M(e.t("component.table.settingDens")),1)]),default:v(()=>[k(a,{placement:"bottom",trigger:["click"],getPopupContainer:e.getPopupContainer},{overlay:v(()=>[k(i,{onClick:e.handleTitleClick,selectable:"",selectedKeys:e.selectedKeysRef,"onUpdate:selectedKeys":o[0]||(o[0]=_=>e.selectedKeysRef=_)},{default:v(()=>[k(c,{key:"default"},{default:v(()=>[te("span",null,M(e.t("component.table.settingDensDefault")),1)]),_:1}),k(c,{key:"middle"},{default:v(()=>[te("span",null,M(e.t("component.table.settingDensMiddle")),1)]),_:1}),k(c,{key:"small"},{default:v(()=>[te("span",null,M(e.t("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["onClick","selectedKeys"])]),default:v(()=>[k(d)]),_:1},8,["getPopupContainer"])]),_:1})}const Nn=ne(fn,[["render",En]]),Mn=me({name:"RedoSetting",components:{RedoOutlined:xt,Tooltip:ot},setup(){const e=ze(),{t:o}=Te();function t(){e.reload()}return{redo:t,t:o}}});function zn(e,o,t,s,l,u){const d=R("RedoOutlined"),c=R("Tooltip");return A(),z(c,{placement:"top"},{title:v(()=>[te("span",null,M(e.t("common.redo")),1)]),default:v(()=>[k(d,{onClick:e.redo},null,8,["onClick"])]),_:1})}const Vn=ne(Mn,[["render",zn]]),Wn=me({name:"FullScreenSetting",components:{FullscreenExitOutlined:en,FullscreenOutlined:tn,Tooltip:ot},setup(){const e=ze(),{t:o}=Te(),{toggle:t,isFullscreen:s}=Wt(e.wrapRef);return{toggle:t,isFullscreen:s,t:o}}});function qn(e,o,t,s,l,u){const d=R("FullscreenOutlined"),c=R("FullscreenExitOutlined"),i=R("Tooltip");return A(),z(i,{placement:"top"},{title:v(()=>[te("span",null,M(e.t("component.table.settingFullScreen")),1)]),default:v(()=>[e.isFullscreen?(A(),z(c,{key:1,onClick:e.toggle},null,8,["onClick"])):(A(),z(d,{key:0,onClick:e.toggle},null,8,["onClick"]))]),_:1})}const jn=ne(Wn,[["render",qn]]),Un=me({name:"TableSetting",components:{ColumnSetting:Ln,SizeSetting:Nn,RedoSetting:Vn,FullScreenSetting:jn},props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(e,{emit:o}){const{t}=Te(),s=ze(),l=F(()=>H({redo:!0,size:!0,setting:!0,fullScreen:!1},e.setting));function u(c){o("columns-change",c)}function d(){return s?n(s.wrapRef):document.body}return{getSetting:l,t,handleColumnChange:u,getTableContainer:d}}}),Gn={class:"table-settings"};function Xn(e,o,t,s,l,u){const d=R("RedoSetting"),c=R("SizeSetting"),i=R("ColumnSetting"),a=R("FullScreenSetting");return A(),ge("div",Gn,[e.getSetting.redo?(A(),z(d,{key:0,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):G("",!0),e.getSetting.size?(A(),z(c,{key:1,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):G("",!0),e.getSetting.setting?(A(),z(i,{key:2,onColumnsChange:e.handleColumnChange,getPopupContainer:e.getTableContainer},null,8,["onColumnsChange","getPopupContainer"])):G("",!0),e.getSetting.fullScreen?(A(),z(a,{key:3,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):G("",!0)])}const Zn=ne(Un,[["render",Xn]]),Yn=me({name:"BasicTableTitle",components:{BasicTitle:qt},props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(e){const{prefixCls:o}=Ke("basic-table-title");return{getTitle:F(()=>{const{title:s,getSelectRows:l=()=>{}}=e;let u=s;return j(s)&&(u=s({selectRows:l()})),u}),prefixCls:o}}});function Jn(e,o,t,s,l,u){const d=R("BasicTitle");return e.getTitle?(A(),z(d,{key:0,class:pe(e.prefixCls),helpMessage:e.helpMessage},{default:v(()=>[ae(M(e.getTitle),1)]),_:1},8,["class","helpMessage"])):G("",!0)}const Qn=ne(Yn,[["render",Jn]]),xn=me({name:"BasicTableHeader",components:{Divider:nn,TableTitle:Qn,TableSetting:Zn},props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(e,{emit:o}){const{prefixCls:t}=Ke("basic-table-header");function s(l){o("columns-change",l)}return{prefixCls:t,handleColumnChange:s}}}),eo={style:{width:"100%"}},to={key:0,style:{margin:"5px"}},no={class:"flex items-center"};function oo(e,o,t,s,l,u){const d=R("TableTitle"),c=R("Divider"),i=R("TableSetting");return A(),ge("div",eo,[e.$slots.headerTop?(A(),ge("div",to,[de(e.$slots,"headerTop")])):G("",!0),te("div",no,[e.$slots.tableTitle?de(e.$slots,"tableTitle",{key:0}):G("",!0),!e.$slots.tableTitle&&e.title?(A(),z(d,{key:1,helpMessage:e.titleHelpMessage,title:e.title},null,8,["helpMessage","title"])):G("",!0),te("div",{class:pe(`${e.prefixCls}__toolbar`)},[de(e.$slots,"toolbar"),e.$slots.toolbar&&e.showTableSetting?(A(),z(c,{key:0,type:"vertical"})):G("",!0),e.showTableSetting?(A(),z(i,{key:1,setting:e.tableSetting,onColumnsChange:e.handleColumnChange},null,8,["setting","onColumnsChange"])):G("",!0)],2)])])}const ao=ne(xn,[["render",oo]]);function lo(e,o,t){return{getHeaderProps:F(()=>{const{title:l,showTableSetting:u,titleHelpMessage:d,tableSetting:c}=n(e),i=!o.tableTitle&&!l&&!o.toolbar&&!u;return i&&!Le(l)?{}:{title:i?null:()=>Ve(ao,{title:l,titleHelpMessage:d,showTableSetting:u,tableSetting:c,onColumnsChange:t.onColumnsChange},H(H(H({},o.toolbar?{toolbar:()=>Ne(o,"toolbar")}:{}),o.tableTitle?{tableTitle:()=>Ne(o,"tableTitle")}:{}),o.headerTop?{headerTop:()=>Ne(o,"headerTop")}:{}))}})}}function so(e,o,t){const s=W([]),l=F(()=>n(e).autoCreateKey&&!n(e).rowKey),u=F(()=>{const{rowKey:_}=n(e);return n(l)?ee:_}),d=F(()=>{const{isTreeTable:_}=n(e);return _?{expandedRowKeys:n(s),onExpandedRowsChange:P=>{s.value=P,t("expanded-rows-change",P)}}:{}});function c(){const _=a();s.value=_}function i(_){const{isTreeTable:P}=n(e);P&&(s.value=[...s.value,..._])}function a(_){const P=[],{childrenColumnName:g}=n(e);return he(_||n(o)).forEach(p=>{P.push(p[n(u)]);const f=p[g||"children"];f!=null&&f.length&&P.push(...a(f))}),P}function C(){s.value=[]}return{getExpandOption:d,expandAll:c,expandRows:i,collapseAll:C}}function io(e,o,t,s,l,u){const d=R("Table");return e.summaryFunc||e.summaryData?(A(),z(d,{key:0,showHeader:!1,bordered:!1,pagination:!1,dataSource:e.getDataSource,rowKey:c=>c[e.rowKey],columns:e.getColumns,tableLayout:"fixed",scroll:e.scroll},null,8,["dataSource","rowKey","columns","scroll"])):G("",!0)}const ro=ne(dn,[["render",io]]);function co(e,o,t,s){const l=F(()=>(n(s)||[]).length===0),u=F(()=>{const{summaryFunc:c,showSummary:i,summaryData:a}=n(e);return i&&!n(l)?()=>Ve(ro,{summaryFunc:c,summaryData:a,scroll:n(o)}):void 0});We(()=>{d()});function d(){const{showSummary:c}=n(e);!c||n(l)||ye(()=>{const i=n(t);if(!i)return;const a=i.$el.querySelector(".ant-table-content");jt({el:a,name:"scroll",listener:()=>{const C=i.$el.querySelector(".ant-table-footer .ant-table-content");!C||!a||(C.scrollLeft=a.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:u}}function uo(e,o,t,s){const l=F(()=>{const{formConfig:i}=n(e),{submitButtonOptions:a}=i||{};return fe(H({showAdvancedButton:!0},i),{submitButtonOptions:H({loading:n(s)},a),compact:!0})}),u=F(()=>Object.keys(o).map(a=>a.startsWith("form-")?a:null).filter(a=>!!a));function d(i){var a,C;return i&&(C=(a=i==null?void 0:i.replace)==null?void 0:a.call(i,/form-/,""))!=null?C:""}function c(i){const{handleSearchInfoFn:a}=n(e);a&&j(a)&&(i=a(i)||i),t({searchInfo:i,page:1})}return{getFormProps:l,replaceFormSlotKey:d,getFormSlotKeys:u,handleSearchInfoChange:c}}const fo=me({name:"BasicTable",components:{Table:on,BasicForm:It,HeaderCell:yn},props:gn,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(e,{attrs:o,emit:t,slots:s,expose:l}){const u=W(null),d=W([]),c=W(null),i=W(null),a=W(),{prefixCls:C}=Ke("basic-table"),[_,P]=At(),g=F(()=>H(H({},e),n(a))),p=ln(Ut,!1);We(()=>{n(p)&&e.canResize&&Gt()});const{getLoading:f,setLoading:h}=In(g),{getPaginationInfo:b,getPagination:B,setPagination:D,setShowPagination:L,getShowPagination:E}=Tn(g),{getRowSelection:q,getRowSelectionRef:le,getSelectRows:y,setSelectedRows:w,clearSelectedRowKeys:r,getSelectRowKeys:m,deleteSelectRowByKey:S,setSelectedRowKeys:$}=Hn(g,d,t),{handleTableChange:O,getDataSourceRef:I,getDataSource:K,getRawDataSource:T,setTableData:Z,updateTableDataRecord:N,deleteTableDataRecord:U,insertTableDataRecord:se,findTableDataRecord:J,fetch:Q,getRowKey:ie,reload:x,getAutoCreateKey:re,updateTableData:ve}=Fn(g,{tableData:d,getPaginationInfo:b,setLoading:h,setPagination:D,getFieldsValue:P.getFieldsValue,clearSelectedRowKeys:r},t);function Re(...V){O.call(void 0,...V),t("change",...V);const{onChange:Y}=n(g);Y&&j(Y)&&Y.call(void 0,...V)}const{getViewColumns:$e,getColumns:Ee,setCacheColumnsByField:be,setCacheColumns:ce,setColumns:_e,getColumnsRef:ue,getCacheColumns:Se}=_n(g,b),{getScrollRef:we,redoHeight:qe}=Pn(g,u,ue,le,I,c,i),{scrollTo:it}=Dn(u,I),{customRow:rt}=An(g,{setSelectedRowKeys:$,getSelectRowKeys:m,clearSelectedRowKeys:r,getAutoCreateKey:re,emit:t}),{getRowClassName:ct}=Bn(g,C),{getExpandOption:ut,expandAll:ft,expandRows:dt,collapseAll:gt}=so(g,d,t),ht={onColumnsChange:V=>{var Y,je;t("columns-change",V),(je=(Y=n(g)).onColumnsChange)==null||je.call(Y,V)}},{getHeaderProps:mt}=lo(g,s,ht),{getFooterProps:pt}=co(g,we,u,I),{getFormProps:Ct,replaceFormSlotKey:bt,getFormSlotKeys:St,handleSearchInfoChange:yt}=uo(g,s,Q,f),ke=F(()=>{const V=n(I);let Y=H(fe(H(H(fe(H({},o),{customRow:rt}),n(g)),n(mt)),{scroll:n(we),loading:n(f),tableLayout:"fixed",rowSelection:n(le),rowKey:n(ie),columns:he(n($e)),pagination:he(n(b)),dataSource:V,footer:n(pt)}),n(ut));return Y=nt(Y,["class","onChange"]),Y}),wt=F(()=>{const V=n(ke);return[C,o.class,{[`${C}-form-container`]:V.useSearchForm,[`${C}--inset`]:V.inset}]}),Tt=F(()=>{const{emptyDataIsShowTable:V,useSearchForm:Y}=n(g);return V||!Y?!0:!!n(I).length});function vt(V){a.value=H(H({},n(a)),V)}const Fe={reload:x,getSelectRows:y,setSelectedRows:w,clearSelectedRowKeys:r,getSelectRowKeys:m,deleteSelectRowByKey:S,setPagination:D,setTableData:Z,updateTableDataRecord:N,deleteTableDataRecord:U,insertTableDataRecord:se,findTableDataRecord:J,redoHeight:qe,setSelectedRowKeys:$,setColumns:_e,setLoading:h,getDataSource:K,getRawDataSource:T,setProps:vt,getRowSelection:q,getPaginationRef:B,getColumns:Ee,getCacheColumns:Se,emit:t,updateTableData:ve,setShowPagination:L,getShowPagination:E,setCacheColumnsByField:be,expandAll:ft,expandRows:dt,collapseAll:gt,scrollTo:it,getSize:()=>n(ke).size,setCacheColumns:ce};return Ot(fe(H({},Fe),{wrapRef:c,getBindValues:ke})),l(Fe),t("register",Fe,P),{formRef:i,tableElRef:u,getBindValues:ke,getLoading:f,registerForm:_,handleSearchInfoChange:yt,getEmptyDataIsShowTable:Tt,handleTableChange:Re,getRowClassName:ct,wrapRef:c,tableAction:Fe,redoHeight:qe,getFormProps:Ct,replaceFormSlotKey:bt,getFormSlotKeys:St,getWrapperClass:wt,columns:$e}}});function go(e,o,t,s,l,u){const d=R("BasicForm"),c=R("HeaderCell"),i=R("Table");return A(),ge("div",{ref:"wrapRef",class:pe(e.getWrapperClass)},[e.getBindValues.useSearchForm?(A(),z(d,Qe({key:0,ref:"formRef",submitOnReset:""},e.getFormProps,{tableAction:e.tableAction,onRegister:e.registerForm,onSubmit:e.handleSearchInfoChange,onAdvancedChange:e.redoHeight}),Je({_:2},[Me(e.getFormSlotKeys,a=>({name:e.replaceFormSlotKey(a),fn:v(C=>[de(e.$slots,a,Ie(He(C||{})))])}))]),1040,["tableAction","onRegister","onSubmit","onAdvancedChange"])):G("",!0),sn(k(i,Qe({ref:"tableElRef"},e.getBindValues,{rowClassName:e.getRowClassName,onChange:e.handleTableChange}),Je({headerCell:v(({column:a})=>[de(e.$slots,"headerCell",Ie(He({column:a})),()=>[k(c,{column:a},null,8,["column"])])]),bodyCell:v(a=>[de(e.$slots,"bodyCell",Ie(He(a||{})))]),_:2},[Me(Object.keys(e.$slots),a=>({name:a,fn:v(C=>[de(e.$slots,a,Ie(He(C||{})))])}))]),1040,["rowClassName","onChange"]),[[rn,e.getEmptyDataIsShowTable]])],2)}const _o=ne(fo,[["render",go]]);export{_o as B,yn as _};
